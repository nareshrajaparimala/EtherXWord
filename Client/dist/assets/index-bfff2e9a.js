import{r as l,a as $e,b as Ne}from"./vendor-3c8011bb.js";import{u as $,L as Z,a as le,B as Fe,R as Me,b as B}from"./router-a78ec674.js";import{F as me,h as He,E as qe,P as Y,T as J,a as Ue,b as _e,c as ve}from"./utils-462b0b0a.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();var we={exports:{}},ie={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var We=l,Je=Symbol.for("react.element"),Ve=Symbol.for("react.fragment"),Ge=Object.prototype.hasOwnProperty,ze=We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Xe={key:!0,ref:!0,__self:!0,__source:!0};function ye(s,t,o){var r,n={},i=null,d=null;o!==void 0&&(i=""+o),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(d=t.ref);for(r in t)Ge.call(t,r)&&!Xe.hasOwnProperty(r)&&(n[r]=t[r]);if(s&&s.defaultProps)for(r in t=s.defaultProps,t)n[r]===void 0&&(n[r]=t[r]);return{$$typeof:Je,type:s,key:i,ref:d,props:n,_owner:ze.current}}ie.Fragment=Ve;ie.jsx=ye;ie.jsxs=ye;we.exports=ie;var e=we.exports,ue={},be=$e;ue.createRoot=be.createRoot,ue.hydrateRoot=be.hydrateRoot;const Qe=()=>{const[s,t]=l.useState(()=>localStorage.getItem("theme")||"dark"),[o,r]=l.useState(!1),[n,i]=l.useState(()=>{const h=localStorage.getItem("userProfile");return h?JSON.parse(h):null}),[d,c]=l.useState(!1),m=l.useRef(null),x=$(),u=()=>{const h=s==="dark"?"light":"dark";t(h),localStorage.setItem("theme",h),document.body.className=h};l.useEffect(()=>{document.body.className=s,document.documentElement.setAttribute("data-theme",s)},[s]),l.useEffect(()=>{localStorage.getItem("accessToken")&&j()},[]),l.useEffect(()=>{const h=()=>{localStorage.getItem("accessToken")?j():i(null)};return window.addEventListener("storage",h),()=>window.removeEventListener("storage",h)},[]);const w=()=>{r(!o)},j=async()=>{c(!0);try{const h=localStorage.getItem("accessToken");if(console.log("Token:",h),!h){console.log("No token found"),i(null);return}console.log("Fetching profile from:","http://localhost:5030/api/auth/profile");const g=await fetch("http://localhost:5030/api/auth/profile",{headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}});if(console.log("Response status:",g.status),g.ok){const N=await g.json();console.log("User data received:",N),i(N),localStorage.setItem("userProfile",JSON.stringify(N))}else{const N=await g.text();console.error("Profile fetch failed:",{status:g.status,statusText:g.statusText,error:N}),i(null),localStorage.removeItem("accessToken"),localStorage.removeItem("userProfile")}}catch(h){console.error("Network error fetching user profile:",{message:h.message,stack:h.stack,name:h.name}),i(null),localStorage.removeItem("userProfile")}finally{c(!1)}},S=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("userProfile"),i(null),r(!1),window.location.href="/signin"};return l.useEffect(()=>{const h=g=>{m.current&&!m.current.contains(g.target)&&r(!1)};return o&&document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[o]),e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:`navbar ${s}`,children:[e.jsx("div",{className:"navbar-left",children:e.jsx("div",{className:"navbar-logo",children:e.jsx("span",{className:"logo-text-main",children:"EtherXWord"})})}),e.jsxs("div",{className:"navbar-right",children:[e.jsx("button",{className:"nav-icon","aria-label":"Notifications",children:"🔔"}),e.jsx("button",{className:"theme-toggle",onClick:u,"aria-label":"Toggle theme",children:s==="dark"?"☀️":"🌙"}),e.jsx("button",{className:"nav-icon profile-btn",onClick:w,"aria-label":"Profile",children:"👤"})]})]}),o&&e.jsx("div",{className:"sidebar-overlay",onClick:()=>r(!1)}),e.jsxs("div",{ref:m,className:`right-sidebar ${o?"open":""} ${s}`,children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h3",{children:"Profile Menu"}),e.jsx("button",{className:"close-btn",onClick:()=>r(!1),children:"✕"})]}),e.jsxs("div",{className:"sidebar-content",children:[e.jsx("div",{className:"profile-section",children:d?e.jsxs("div",{className:"profile-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading profile..."})]}):n&&n.fullName&&n.email?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"profile-avatar",children:n.fullName.charAt(0).toUpperCase()}),e.jsxs("div",{className:"profile-info",children:[e.jsx("h4",{children:n.fullName}),e.jsx("p",{children:n.email})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"profile-avatar",children:"👤"}),e.jsxs("div",{className:"profile-info",children:[e.jsx("h4",{children:"Guest User"}),e.jsx("p",{children:"Please sign in"}),e.jsxs("small",{style:{color:"#666"},children:["Token: ",localStorage.getItem("accessToken")?"Present":"Missing"]}),e.jsx("button",{onClick:j,style:{marginTop:"10px",padding:"5px 10px",fontSize:"12px"},children:"Refresh Profile"})]})]})}),e.jsxs("div",{className:"sidebar-menu",children:[e.jsxs("button",{className:"sidebar-item",onClick:()=>{x("/profile"),r(!1)},children:[e.jsx("span",{className:"item-icon",children:"👤"}),e.jsx("span",{children:"Profile"})]}),e.jsxs("button",{className:"sidebar-item",onClick:()=>{x("/settings"),r(!1)},children:[e.jsx("span",{className:"item-icon",children:"⚙️"}),e.jsx("span",{children:"Settings"})]}),e.jsxs("button",{className:"sidebar-item",onClick:()=>{x("/"),r(!1)},children:[e.jsx("span",{className:"item-icon",children:"📊"}),e.jsx("span",{children:"Dashboard"})]}),e.jsxs("button",{className:"sidebar-item",onClick:()=>{x("/"),r(!1)},children:[e.jsx("span",{className:"item-icon",children:"📄"}),e.jsx("span",{children:"Documents"})]}),e.jsxs("button",{className:"sidebar-item",children:[e.jsx("span",{className:"item-icon",children:"🔔"}),e.jsx("span",{children:"Notifications"})]}),e.jsxs("button",{className:"sidebar-item logout",onClick:S,children:[e.jsx("span",{className:"item-icon",children:"🚪"}),e.jsx("span",{children:"Logout"})]})]})]})]})]})};const Ke=()=>e.jsx("div",{className:"loading-container",children:e.jsxs("div",{className:"loading-content",children:[e.jsxs("div",{className:"logo-container",children:[e.jsxs("div",{className:"logo-text",children:[e.jsx("span",{className:"letter",children:"E"}),e.jsx("span",{className:"letter",children:"t"}),e.jsx("span",{className:"letter",children:"h"}),e.jsx("span",{className:"letter",children:"e"}),e.jsx("span",{className:"letter",children:"r"}),e.jsx("span",{className:"letter",children:"X"}),e.jsx("span",{className:"letter",children:"W"}),e.jsx("span",{className:"letter",children:"o"}),e.jsx("span",{className:"letter",children:"r"}),e.jsx("span",{className:"letter",children:"d"})]}),e.jsx("div",{className:"tagline",children:"Decentralized Document Editor"})]}),e.jsxs("div",{className:"loading-animation",children:[e.jsxs("div",{className:"spinner",children:[e.jsx("div",{className:"spinner-ring"}),e.jsx("div",{className:"spinner-ring"}),e.jsx("div",{className:"spinner-ring"})]}),e.jsx("div",{className:"loading-text",children:"Loading..."})]}),e.jsxs("div",{className:"particles",children:[e.jsx("div",{className:"particle"}),e.jsx("div",{className:"particle"}),e.jsx("div",{className:"particle"}),e.jsx("div",{className:"particle"}),e.jsx("div",{className:"particle"})]})]})});const Ye=()=>{const[s,t]=l.useState(!1),[o,r]=l.useState("Quick Access");l.useState(!1);const n=$(),i=[{icon:"📄",label:"Quick Access",mobileVisible:!1},{icon:"➕",label:"New Document",mobileVisible:!0},{icon:"📑",label:"Templates",mobileVisible:!1},{icon:"📂",label:"All Documents",mobileVisible:!0},{icon:"⭐",label:"Favorites",mobileVisible:!1},{icon:"🗑️",label:"Trash",mobileVisible:!1},{icon:"⚙️",label:"Settings",mobileVisible:!1}],d=[{title:"Project Proposal",preview:"Lorem ipsum dolor sit amet...",lastEdit:"2 hours ago"},{title:"Meeting Notes",preview:"Team meeting discussion...",lastEdit:"1 day ago"},{title:"Research Paper",preview:"Academic research on...",lastEdit:"3 days ago"}];return e.jsxs("div",{className:"home-container",children:[e.jsx("div",{className:"home-header",children:e.jsx("button",{className:"sidebar-toggle",onClick:()=>t(!s),children:"☰"})}),e.jsx("aside",{className:`home-sidebar ${s?"collapsed":""}`,children:e.jsx("div",{className:"sidebar-content",children:i.map((c,m)=>e.jsxs("button",{className:`sidebar-item ${o===c.label?"active":""} ${c.mobileVisible?"mobile-visible":""}`,onClick:()=>r(c.label),children:[e.jsx("span",{className:"sidebar-icon",children:c.icon}),e.jsx("span",{className:"sidebar-label",children:c.label})]},m))})}),e.jsxs("main",{className:"workspace",children:[o==="Quick Access"&&e.jsxs("div",{className:"workspace-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"Quick Access"}),e.jsxs("div",{className:"quick-actions",children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>n("/editor"),children:"➕ New Document"}),e.jsx("button",{className:"btn btn-secondary",children:"📑 Default Template"})]})]}),e.jsx("div",{className:"search-container",children:e.jsx("input",{type:"text",placeholder:"Search by title, tags, or date",className:"search-input"})}),e.jsx("div",{className:"documents-grid",children:d.map((c,m)=>e.jsxs("div",{className:"document-card",onClick:()=>n("/editor"),children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{children:c.title}),e.jsx("button",{className:"card-menu",onClick:x=>x.stopPropagation(),children:"⋯"})]}),e.jsx("p",{className:"card-preview",children:c.preview}),e.jsx("div",{className:"card-footer",children:e.jsx("span",{className:"last-edit",children:c.lastEdit})})]},m))}),e.jsxs("div",{className:"templates-section",children:[e.jsx("h3",{children:"Suggested Templates"}),e.jsxs("div",{className:"templates-slider",children:[e.jsx("div",{className:"template-card",children:"📄 Blank Document"}),e.jsx("div",{className:"template-card",children:"📊 Report Template"}),e.jsx("div",{className:"template-card",children:"📝 Meeting Notes"}),e.jsx("div",{className:"template-card",children:"📋 Project Plan"})]})]})]}),o==="New Document"&&e.jsxs("div",{className:"workspace-section",children:[e.jsx("h2",{children:"Create New Document"}),e.jsxs("div",{className:"new-doc-options",children:[e.jsx("button",{className:"new-doc-btn",onClick:()=>n("/editor"),children:"📄 Blank Document"}),e.jsx("button",{className:"new-doc-btn",children:"📑 From Template"}),e.jsx("button",{className:"new-doc-btn",children:"📤 Import File"})]})]}),o==="All Documents"&&e.jsxs("div",{className:"workspace-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"All Documents"}),e.jsx("div",{className:"filters",children:e.jsxs("select",{className:"filter-select",children:[e.jsx("option",{children:"Sort by Date"}),e.jsx("option",{children:"Sort by Name"}),e.jsx("option",{children:"Sort by Type"})]})})]}),e.jsx("div",{className:"documents-list",children:d.map((c,m)=>e.jsxs("div",{className:"document-row",children:[e.jsxs("div",{className:"doc-info",children:[e.jsx("h4",{children:c.title}),e.jsx("span",{className:"doc-date",children:c.lastEdit})]}),e.jsxs("div",{className:"doc-actions",children:[e.jsx("button",{onClick:()=>n("/editor"),children:"✏️"}),e.jsx("button",{children:"📤"}),e.jsx("button",{children:"🗑️"})]})]},m))})]}),!["Quick Access","New Document","All Documents"].includes(o)&&e.jsxs("div",{className:"workspace-section",children:[e.jsx("h2",{children:o}),e.jsxs("p",{children:["Content for ",o," coming soon..."]})]})]})]})};const fe=()=>{const[s,t]=l.useState("Untitled Document"),[o,r]=l.useState(!1),[n,i]=l.useState(!1),[d,c]=l.useState(!1),[m,x]=l.useState(null),[u,w]=l.useState([]),[j,S]=l.useState([]),[h,g]=l.useState(""),[N,y]=l.useState(!1),[A,q]=l.useState(!1),[I,V]=l.useState({enabled:!1,color:"#FFD700",width:"2px",style:"solid",margin:"20px"}),D=l.useRef(null),se=$(),X=l.useRef(null),k=(a,p=null)=>{document.execCommand(a,!1,p),D.current.focus()},ce=async(a=!1)=>{const p=D.current.innerHTML,C=new Date().toISOString(),P={id:Date.now().toString(),title:s,content:p,lastModified:C,wordCount:D.current.innerText.trim().split(/\s+/).length,collaborators:j},v=[{id:Date.now().toString(),content:p,timestamp:C,author:localStorage.getItem("userProfile")?JSON.parse(localStorage.getItem("userProfile")).fullName:"Anonymous",changes:"Document updated"},...u.slice(0,9)];w(v),localStorage.setItem(`history_${s}`,JSON.stringify(v));const T=JSON.parse(localStorage.getItem("documents")||"[]"),E=T.findIndex(R=>R.title===s);E>=0?T[E]=P:T.push(P),localStorage.setItem("documents",JSON.stringify(T));const L=JSON.parse(localStorage.getItem("recentDocuments")||"[]"),U=L.findIndex(R=>R.title===s);U>=0&&L.splice(U,1),L.unshift({title:s,lastModified:C}),localStorage.setItem("recentDocuments",JSON.stringify(L.slice(0,10))),a||alert("Document saved successfully!")},ke=()=>{if(confirm("Are you sure you want to delete this document?")){const a={title:s,content:D.current.innerHTML,deletedAt:new Date().toISOString(),deletedBy:localStorage.getItem("userProfile")?JSON.parse(localStorage.getItem("userProfile")).fullName:"Anonymous"},p=JSON.parse(localStorage.getItem("deletedDocuments")||"[]");p.unshift(a),localStorage.setItem("deletedDocuments",JSON.stringify(p));const P=JSON.parse(localStorage.getItem("documents")||"[]").filter(b=>b.title!==s);localStorage.setItem("documents",JSON.stringify(P)),se("/")}},he=()=>{const a=`${window.location.origin}/editor/shared/${btoa(s)}`;g(a),navigator.clipboard.writeText(a),alert("Share link copied to clipboard!")},Ce=()=>{const a=prompt("Enter collaborator email:");if(a&&a.includes("@")){const p={id:Date.now().toString(),email:a,role:"editor",addedAt:new Date().toISOString()};S([...j,p])}},Pe=a=>{confirm("Restore this version? Current changes will be lost.")&&(D.current.innerHTML=a.content,ce(),y(!1))},Te=()=>{X.current&&clearInterval(X.current),X.current=setInterval(()=>{ce(!0)},3e4)};Ne.useEffect(()=>{const a=JSON.parse(localStorage.getItem(`history_${s}`)||"[]");return w(a),Te(),()=>{X.current&&clearInterval(X.current)}},[s]);const Ee=a=>{a.preventDefault();const p=a.dataTransfer.files;if(p[0]&&p[0].type.startsWith("image/")){const C=new FileReader;C.onload=P=>{const b=document.createElement("img");b.src=P.target.result,b.style.maxWidth="100%",b.style.height="auto",b.style.border="1px solid #ddd",b.style.borderRadius="4px",b.style.cursor="pointer",b.onclick=v=>{v.stopPropagation(),x(b),document.querySelectorAll(".editor-content img").forEach(T=>T.classList.remove("selected")),b.classList.add("selected")},D.current.appendChild(b)},C.readAsDataURL(p[0])}},Ie=a=>{a.target.tagName!=="IMG"&&(x(null),document.querySelectorAll(".editor-content img").forEach(p=>p.classList.remove("selected")))},te=a=>{m&&(m.style.width=a,m.style.height="auto")},ae=a=>{m&&(m.style.border=a)},De=()=>{q(!A)},Le=()=>{V({...I,enabled:!0}),q(!1)},Ae=()=>{V({...I,enabled:!1})},G=async a=>{const p=D.current.innerHTML;D.current.innerText;try{switch(a){case"pdf":await Oe();break;case"docx":await Re();break;case"md":const C=Be(p),P=new Blob([C],{type:"text/markdown"});me.saveAs(P,`${s}.md`);break;default:const b=new Blob([p],{type:"text/html"});me.saveAs(b,`${s}.html`)}}catch(C){console.error("Export failed:",C),alert("Export failed. Please try again.")}},Oe=async()=>{D.current.blur(),await new Promise(v=>setTimeout(v,100));const a=D.current,p=document.createElement("div");p.style.cssText=`
      position: absolute;
      top: -9999px;
      left: -9999px;
      width: 800px;
      background: white;
      padding: 40px;
      font-family: Georgia, serif;
      font-size: 16px;
      line-height: 1.6;
      color: black;
    `,p.innerHTML=a.innerHTML;const C=a.querySelectorAll("*"),P=p.querySelectorAll("*");C.forEach((v,T)=>{if(P[T]){const E=window.getComputedStyle(v),L=P[T];E.textAlign&&E.textAlign!=="start"&&(L.style.textAlign=E.textAlign),E.color&&E.color!=="rgb(0, 0, 0)"&&(L.style.color=E.color),E.backgroundColor&&E.backgroundColor!=="rgba(0, 0, 0, 0)"&&(L.style.backgroundColor=E.backgroundColor)}}),p.querySelectorAll("img").forEach(v=>{const T=window.getComputedStyle(v.parentElement);v.style.maxWidth="100%",v.style.height="auto",v.style.display="block",v.style.margin="10px 0",T.textAlign&&(v.style.marginLeft=T.textAlign==="center"?"auto":"0",v.style.marginRight=T.textAlign==="center"?"auto":"0")}),document.body.appendChild(p);try{const v=await He(p,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",width:800,height:p.scrollHeight}),T=v.toDataURL("image/png"),E=new qe("p","mm","a4"),L=210,U=295,R=v.height*L/v.width;let _=R,f=0;for(E.addImage(T,"PNG",0,f,L,R),_-=U;_>=0;)f=_-R,E.addPage(),E.addImage(T,"PNG",0,f,L,R),_-=U;E.save(`${s}.pdf`)}finally{document.body.removeChild(p)}},Re=async()=>{var _;D.current.blur(),await new Promise(f=>setTimeout(f,100));const a=D.current,p=a.innerHTML,C=document.createElement("div");C.innerHTML=p;const P=[],b=f=>{switch(window.getComputedStyle(f).textAlign){case"center":return"center";case"right":return"right";case"justify":return"both";default:return"left"}},v=f=>{var Q,M,O;const W=(Q=f.textContent)==null?void 0:Q.trim();if(!W)return null;const F=window.getComputedStyle(f),ne=f.tagName==="STRONG"||f.tagName==="B"||f.style.fontWeight==="bold"||F.fontWeight==="bold",de=f.tagName==="EM"||f.tagName==="I"||f.style.fontStyle==="italic"||F.fontStyle==="italic",re=f.tagName==="U"||((M=f.style.textDecoration)==null?void 0:M.includes("underline"))||((O=F.textDecoration)==null?void 0:O.includes("underline"));return new J({text:W,bold:ne,italics:de,underline:re})},T=a.querySelectorAll("p, div"),E=C.querySelectorAll("p, div");if(E.length===0){const f=(_=C.textContent)==null?void 0:_.trim();f&&P.push(new Y({children:[new J(f)],alignment:"left"}))}else E.forEach((f,W)=>{var ne;const F=(ne=f.textContent)==null?void 0:ne.trim();if(F){const de=T[W]||a,re=b(de),Q=f.querySelectorAll("strong, b, em, i, u");if(Q.length>0){const M=[];let O=F;Q.forEach(pe=>{var xe;const K=(xe=pe.textContent)==null?void 0:xe.trim();if(K&&O.includes(K)){const ge=O.substring(0,O.indexOf(K));ge.trim()&&M.push(new J(ge.trim()));const je=v(pe);je&&M.push(je),O=O.substring(O.indexOf(K)+K.length)}}),O.trim()&&M.push(new J(O.trim())),M.length>0&&P.push(new Y({children:M,alignment:re}))}else P.push(new Y({children:[new J(F)],alignment:re}))}});a.querySelectorAll("img").forEach((f,W)=>{P.push(new Y({children:[new J(`[Image ${W+1}: ${f.alt||"Embedded image"}]`)]}))});const U=new Ue({sections:[{properties:{},children:P.length>0?P:[new Y({children:[new J("Empty document")]})]}]}),R=await _e.toBlob(U);me.saveAs(R,`${s}.docx`)},Be=a=>a.replace(/<h1[^>]*>(.*?)<\/h1>/gi,`# $1
`).replace(/<h2[^>]*>(.*?)<\/h2>/gi,`## $1
`).replace(/<h3[^>]*>(.*?)<\/h3>/gi,`### $1
`).replace(/<strong[^>]*>(.*?)<\/strong>/gi,"**$1**").replace(/<b[^>]*>(.*?)<\/b>/gi,"**$1**").replace(/<em[^>]*>(.*?)<\/em>/gi,"*$1*").replace(/<i[^>]*>(.*?)<\/i>/gi,"*$1*").replace(/<p[^>]*>(.*?)<\/p>/gi,`$1

`).replace(/<br[^>]*>/gi,`
`).replace(/<[^>]*>/g,"").replace(/\n\s*\n\s*\n/g,`

`);return e.jsxs("div",{className:"editor-container",children:[e.jsxs("nav",{className:"editor-navbar",children:[e.jsxs("div",{className:"navbar-left",children:[e.jsx("button",{className:"sidebar-toggle",onClick:()=>i(!n),children:"☰"}),e.jsx("div",{className:"logo",children:"EtherXWord"})]}),e.jsx("div",{className:"navbar-center",children:o?e.jsx("input",{type:"text",value:s,onChange:a=>t(a.target.value),onBlur:()=>r(!1),onKeyPress:a=>a.key==="Enter"&&r(!1),className:"title-input",autoFocus:!0}):e.jsx("h1",{className:"document-title",onClick:()=>r(!0),children:s})}),e.jsxs("div",{className:"navbar-right",children:[e.jsx("button",{className:"nav-btn",onClick:()=>ce(),children:"💾 Save"}),e.jsx("button",{className:"nav-btn",onClick:he,children:"👥 Share"}),e.jsx("button",{className:"nav-btn",onClick:ke,children:"🗑️ Delete"}),e.jsx("button",{className:"nav-icon",children:"🔔"}),e.jsxs("div",{className:"profile-dropdown",children:[e.jsx("button",{className:"nav-icon",onClick:()=>c(!d),children:"👤"}),d&&e.jsxs("div",{className:"dropdown-menu",children:[e.jsx("button",{onClick:()=>se("/profile"),children:"Profile"}),e.jsx("button",{onClick:()=>se("/settings"),children:"Settings"}),e.jsx("button",{onClick:()=>se("/signin"),children:"Logout"})]})]})]})]}),e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-group",children:[e.jsx("button",{onClick:()=>k("bold"),className:"toolbar-btn",children:e.jsx("strong",{children:"B"})}),e.jsx("button",{onClick:()=>k("italic"),className:"toolbar-btn",children:e.jsx("em",{children:"I"})}),e.jsx("button",{onClick:()=>k("underline"),className:"toolbar-btn",children:e.jsx("u",{children:"U"})}),e.jsx("button",{onClick:()=>k("strikeThrough"),className:"toolbar-btn",children:e.jsx("s",{children:"S"})})]}),e.jsxs("div",{className:"toolbar-group",children:[e.jsxs("select",{onChange:a=>k("fontSize",a.target.value),className:"toolbar-select",children:[e.jsx("option",{value:"3",children:"12px"}),e.jsx("option",{value:"4",defaultValue:!0,children:"14px"}),e.jsx("option",{value:"5",children:"18px"}),e.jsx("option",{value:"6",children:"24px"}),e.jsx("option",{value:"7",children:"36px"})]}),e.jsxs("select",{onChange:a=>k("fontName",a.target.value),className:"toolbar-select",children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Georgia",children:"Georgia"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Courier New",children:"Courier New"})]}),e.jsx("input",{type:"color",onChange:a=>k("foreColor",a.target.value),className:"color-picker",title:"Text Color"}),e.jsx("input",{type:"color",onChange:a=>k("backColor",a.target.value),className:"color-picker",title:"Background Color"})]}),e.jsxs("div",{className:"toolbar-group",children:[e.jsx("button",{onClick:()=>k("justifyLeft"),className:"toolbar-btn",children:"⬅️"}),e.jsx("button",{onClick:()=>k("justifyCenter"),className:"toolbar-btn",children:"↔️"}),e.jsx("button",{onClick:()=>k("justifyRight"),className:"toolbar-btn",children:"➡️"}),e.jsx("button",{onClick:()=>k("justifyFull"),className:"toolbar-btn",children:"↕️"})]}),e.jsxs("div",{className:"toolbar-group",children:[e.jsx("button",{onClick:()=>k("insertUnorderedList"),className:"toolbar-btn",children:"• List"}),e.jsx("button",{onClick:()=>k("insertOrderedList"),className:"toolbar-btn",children:"1. List"}),e.jsx("button",{onClick:De,className:"toolbar-btn",children:"🔲 Page Border"}),e.jsx("button",{onClick:()=>k("createLink",prompt("Enter URL:")),className:"toolbar-btn",children:"🔗 Link"})]}),e.jsxs("div",{className:"toolbar-group mobile-hidden",children:[e.jsx("button",{onClick:()=>G("pdf"),className:"toolbar-btn",children:"📄 PDF"}),e.jsx("button",{onClick:()=>G("docx"),className:"toolbar-btn",children:"📝 DOCX"})]})]}),e.jsxs("div",{className:"editor-layout",children:[e.jsxs("aside",{className:`left-sidebar ${n?"collapsed":""}`,children:[e.jsxs("div",{className:"sidebar-section",children:[e.jsx("h3",{children:"📄 Document"}),e.jsx("button",{className:"sidebar-btn",children:"📊 Word Count"}),e.jsx("button",{className:"sidebar-btn",children:"🔍 Find & Replace"}),e.jsx("button",{className:"sidebar-btn",children:"📋 Outline"})]}),e.jsxs("div",{className:"sidebar-section",children:[e.jsx("h3",{children:"🎨 Format"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>k("formatBlock","h1"),children:"🎨 Heading 1"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>k("formatBlock","h2"),children:"🎨 Heading 2"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>k("formatBlock","p"),children:"🎨 Paragraph"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>k("indent"),children:"➡️ Indent"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>k("outdent"),children:"⬅️ Outdent"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>k("insertHTML","<br><br>"),children:"📏 Line Spacing"})]})]}),e.jsxs("div",{className:"editor-wrapper",children:[e.jsx("div",{className:"editor-page",style:I.enabled?{border:`${I.width} ${I.style} ${I.color}`,margin:I.margin}:{},children:e.jsxs("div",{ref:D,contentEditable:!0,className:"editor-content",suppressContentEditableWarning:!0,onDrop:Ee,onDragOver:a=>a.preventDefault(),onClick:Ie,onInput:()=>{},style:I.enabled?{padding:"60px 80px"}:{},children:[e.jsx("p",{children:"Start writing your document here..."}),e.jsx("p",{style:{color:"#999",fontSize:"14px"},children:"💡 Drag and drop images here to insert them"})]})}),m&&e.jsxs("div",{className:"image-controls",children:[e.jsx("h4",{children:"Image Controls"}),e.jsxs("div",{className:"control-group",children:[e.jsx("button",{onClick:()=>te("25%"),children:"25%"}),e.jsx("button",{onClick:()=>te("50%"),children:"50%"}),e.jsx("button",{onClick:()=>te("75%"),children:"75%"}),e.jsx("button",{onClick:()=>te("100%"),children:"100%"})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("button",{onClick:()=>ae("1px solid #ddd"),children:"Light Border"}),e.jsx("button",{onClick:()=>ae("2px solid #FFD700"),children:"Gold Border"}),e.jsx("button",{onClick:()=>ae("3px solid #000"),children:"Bold Border"}),e.jsx("button",{onClick:()=>ae("none"),children:"No Border"})]})]}),A&&e.jsxs("div",{className:"page-border-controls",children:[e.jsx("h4",{children:"Page Border Settings"}),e.jsxs("div",{className:"border-control-group",children:[e.jsx("label",{children:"Border Color:"}),e.jsx("input",{type:"color",value:I.color,onChange:a=>V({...I,color:a.target.value}),className:"border-color-picker"})]}),e.jsxs("div",{className:"border-control-group",children:[e.jsx("label",{children:"Border Width:"}),e.jsxs("select",{value:I.width,onChange:a=>V({...I,width:a.target.value}),className:"border-select",children:[e.jsx("option",{value:"1px",children:"1px"}),e.jsx("option",{value:"2px",children:"2px"}),e.jsx("option",{value:"3px",children:"3px"}),e.jsx("option",{value:"4px",children:"4px"}),e.jsx("option",{value:"5px",children:"5px"})]})]}),e.jsxs("div",{className:"border-control-group",children:[e.jsx("label",{children:"Border Style:"}),e.jsxs("select",{value:I.style,onChange:a=>V({...I,style:a.target.value}),className:"border-select",children:[e.jsx("option",{value:"solid",children:"Solid"}),e.jsx("option",{value:"dashed",children:"Dashed"}),e.jsx("option",{value:"dotted",children:"Dotted"}),e.jsx("option",{value:"double",children:"Double"})]})]}),e.jsxs("div",{className:"border-control-group",children:[e.jsx("label",{children:"Margin:"}),e.jsxs("select",{value:I.margin,onChange:a=>V({...I,margin:a.target.value}),className:"border-select",children:[e.jsx("option",{value:"10px",children:"10px"}),e.jsx("option",{value:"15px",children:"15px"}),e.jsx("option",{value:"20px",children:"20px"}),e.jsx("option",{value:"25px",children:"25px"}),e.jsx("option",{value:"30px",children:"30px"})]})]}),e.jsxs("div",{className:"border-actions",children:[e.jsx("button",{onClick:Le,className:"apply-border-btn",children:"Apply Border"}),e.jsx("button",{onClick:Ae,className:"remove-border-btn",children:"Remove Border"}),e.jsx("button",{onClick:()=>q(!1),className:"cancel-border-btn",children:"Cancel"})]})]})]}),e.jsxs("aside",{className:"right-sidebar",children:[e.jsxs("div",{className:"sidebar-section",children:[e.jsx("h3",{children:"🛠️ Tools"}),e.jsx("button",{className:"sidebar-btn",children:"✏️ Comments"}),e.jsx("button",{className:"sidebar-btn",children:"📝 Suggestions"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>y(!0),children:"🕑 Version History"}),e.jsxs("button",{className:"sidebar-btn",children:["📊 Word Count: ",D.current?D.current.innerText.trim().split(/\s+/).length:0]}),e.jsx("button",{className:"sidebar-btn",onClick:()=>document.querySelector('input[type="file"]').click(),children:"📁 Upload Image"}),e.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:a=>{const p=a.target.files[0];if(p){const C=new FileReader;C.onload=P=>{const b=document.createElement("img");b.src=P.target.result,b.style.maxWidth="100%",b.style.height="auto",b.style.cursor="pointer",b.onclick=v=>{v.stopPropagation(),x(b),document.querySelectorAll(".editor-content img").forEach(T=>T.classList.remove("selected")),b.classList.add("selected")},D.current.appendChild(b)},C.readAsDataURL(p)}}})]}),e.jsxs("div",{className:"sidebar-section",children:[e.jsx("h3",{children:"👥 Collaboration"}),e.jsx("button",{className:"sidebar-btn",onClick:Ce,children:"👤 Add Collaborator"}),e.jsx("button",{className:"sidebar-btn",onClick:he,children:"🔗 Generate Link"}),e.jsx("div",{className:"collaborators",children:j.map(a=>e.jsxs("div",{className:"collaborator-item",children:[e.jsx("div",{className:"collaborator-avatar",children:a.email.charAt(0).toUpperCase()}),e.jsx("span",{className:"collaborator-email",children:a.email})]},a.id))}),h&&e.jsxs("div",{className:"share-link",children:[e.jsx("small",{children:"Share Link:"}),e.jsx("input",{type:"text",value:h,readOnly:!0,onClick:a=>a.target.select()})]})]}),e.jsxs("div",{className:"sidebar-section",children:[e.jsx("h3",{children:"📤 Export"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>G("pdf"),children:"📄 PDF"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>G("docx"),children:"📝 DOCX"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>G("md"),children:"📋 Markdown"}),e.jsx("button",{className:"sidebar-btn",onClick:()=>G("html"),children:"🌐 HTML"})]})]})]}),N&&e.jsx("div",{className:"modal-overlay",onClick:()=>y(!1),children:e.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Version History"}),e.jsx("button",{className:"close-btn",onClick:()=>y(!1),children:"✕"})]}),e.jsx("div",{className:"modal-body",children:u.length===0?e.jsx("p",{children:"No version history available"}):u.map(a=>e.jsxs("div",{className:"version-item",children:[e.jsxs("div",{className:"version-info",children:[e.jsx("strong",{children:new Date(a.timestamp).toLocaleString()}),e.jsxs("span",{children:["by ",a.author]})]}),e.jsxs("div",{className:"version-actions",children:[e.jsx("button",{onClick:()=>Pe(a),children:"Restore"}),e.jsx("button",{onClick:()=>{const p=document.createElement("div");p.innerHTML=a.content,alert(p.textContent.substring(0,200)+"...")},children:"Preview"})]})]},a.id))})]})})]})};const Ze=()=>{var r;const[s,t]=l.useState(null),o=$();return l.useEffect(()=>{const n=localStorage.getItem("userProfile");n?t(JSON.parse(n)):o("/signin")},[o]),s?e.jsxs("div",{className:"profile-container",children:[e.jsxs("div",{className:"profile-header",children:[e.jsx("button",{className:"back-btn",onClick:()=>o("/"),children:"← Back to Home"}),e.jsx("h1",{children:"Profile"})]}),e.jsx("div",{className:"profile-content",children:e.jsxs("div",{className:"profile-card",children:[e.jsx("div",{className:"profile-avatar-large",children:((r=s.fullName)==null?void 0:r.charAt(0).toUpperCase())||"U"}),e.jsx("h2",{children:s.fullName||"User"}),e.jsx("p",{children:s.email||"No email"}),e.jsxs("div",{className:"profile-actions",children:[e.jsx("button",{className:"btn btn-primary",children:"Edit Profile"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>o("/settings"),children:"Settings"})]})]})})]}):e.jsx("div",{className:"loading",children:"Loading..."})},oe=({label:s,type:t="text",name:o,value:r,onChange:n,placeholder:i,required:d=!1,error:c})=>e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:o,className:"form-label",children:[s," ",d&&e.jsx("span",{style:{color:"var(--error)"},children:"*"})]}),e.jsx("input",{type:t,id:o,name:o,value:r,onChange:n,placeholder:i,className:"form-input",required:d}),c&&e.jsx("div",{className:"error-message",children:c})]}),ee=({label:s,name:t,value:o,onChange:r,placeholder:n,required:i=!1,error:d})=>{const[c,m]=l.useState(!1);return e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:t,className:"form-label",children:[s," ",i&&e.jsx("span",{style:{color:"var(--error)"},children:"*"})]}),e.jsxs("div",{className:"password-input-container",children:[e.jsx("input",{type:c?"text":"password",id:t,name:t,value:o,onChange:r,placeholder:n,className:"form-input",required:i}),e.jsx("button",{type:"button",className:"password-toggle",onClick:()=>m(!c),children:c?"👁️":"👁️‍🗨️"})]}),d&&e.jsx("div",{className:"error-message",children:d})]})},Se="http://localhost:5030",H=ve.create({baseURL:`${Se}/api`,headers:{"Content-Type":"application/json"}});H.interceptors.request.use(s=>{const t=localStorage.getItem("accessToken");return t&&(s.headers.Authorization=`Bearer ${t}`),s});H.interceptors.response.use(s=>s,async s=>{var t;if(((t=s.response)==null?void 0:t.status)===401){const o=localStorage.getItem("refreshToken");if(o)try{const r=await ve.post(`${Se}/api/auth/refresh`,{refreshToken:o});return localStorage.setItem("accessToken",r.data.accessToken),H.request(s.config)}catch{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/signin"}}return Promise.reject(s)});const z={signup:async s=>(await H.post("/auth/signup",s)).data,signin:async s=>{const t=await H.post("/auth/signin",s);return t.data.accessToken&&(localStorage.setItem("accessToken",t.data.accessToken),localStorage.setItem("refreshToken",t.data.refreshToken),localStorage.setItem("userProfile",JSON.stringify(t.data.user)),window.dispatchEvent(new Event("storage"))),t.data},forgotPassword:async s=>(await H.post("/auth/forgot-password",{email:s})).data,verifyOtp:async(s,t)=>(await H.post("/auth/verify-otp",{email:s,otp:t})).data,resetPassword:async(s,t,o)=>(await H.post("/auth/reset-password",{newPassword:s,confirmPassword:t},{headers:{Authorization:`Bearer ${o}`}})).data,logout:()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")},isAuthenticated:()=>!!localStorage.getItem("accessToken")},es=()=>{const s=$(),[t,o]=l.useState({fullName:"",email:"",password:"",confirmPassword:"",agreeToTerms:!1}),[r,n]=l.useState({}),[i,d]=l.useState(!1),c=u=>{const{name:w,value:j,type:S,checked:h}=u.target;o(g=>({...g,[w]:S==="checkbox"?h:j})),r[w]&&n(g=>({...g,[w]:""}))},m=()=>{const u={};return t.fullName.trim()||(u.fullName="Full name is required"),t.email.trim()||(u.email="Email is required"),t.password||(u.password="Password is required"),t.password!==t.confirmPassword&&(u.confirmPassword="Passwords do not match"),t.agreeToTerms||(u.agreeToTerms="You must agree to terms"),n(u),Object.keys(u).length===0},x=async u=>{var w,j;if(u.preventDefault(),!!m()){d(!0);try{await z.signup({fullName:t.fullName,email:t.email,password:t.password}),s("/signin",{state:{message:"Account created successfully! Please sign in."}})}catch(S){n({submit:((j=(w=S.response)==null?void 0:w.data)==null?void 0:j.message)||"Registration failed"})}finally{d(!1)}}};return e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card",children:[e.jsxs("div",{className:"auth-header",children:[e.jsx("h1",{className:"auth-title",children:"Create Account"}),e.jsx("p",{className:"auth-subtitle",children:"Join EtherXWord and start creating"})]}),e.jsxs("form",{onSubmit:x,className:"auth-form",children:[e.jsx(oe,{label:"Full Name",name:"fullName",value:t.fullName,onChange:c,placeholder:"Enter your full name",required:!0,error:r.fullName}),e.jsx(oe,{label:"Email",type:"email",name:"email",value:t.email,onChange:c,placeholder:"you@example.com",required:!0,error:r.email}),e.jsx(ee,{label:"Password",name:"password",value:t.password,onChange:c,placeholder:"At least 8 characters",required:!0,error:r.password}),e.jsx(ee,{label:"Confirm Password",name:"confirmPassword",value:t.confirmPassword,onChange:c,placeholder:"Re-enter your password",required:!0,error:r.confirmPassword}),e.jsxs("div",{className:"form-group",children:[e.jsxs("div",{className:"checkbox-group",children:[e.jsx("input",{type:"checkbox",id:"agreeToTerms",name:"agreeToTerms",checked:t.agreeToTerms,onChange:c,className:"checkbox"}),e.jsx("label",{htmlFor:"agreeToTerms",className:"form-label",style:{marginBottom:0},children:"I agree to the Terms of Service"})]}),r.agreeToTerms&&e.jsx("div",{className:"error-message",children:r.agreeToTerms})]}),r.submit&&e.jsx("div",{className:"error-message",children:r.submit}),e.jsx("button",{type:"submit",className:`btn btn-primary ${i?"loading":""}`,style:{width:"100%"},disabled:i,children:i?e.jsx("span",{className:"spinner"}):"Create Account"})]}),e.jsx("div",{className:"auth-divider",children:e.jsx("span",{children:"or"})}),e.jsxs("button",{className:"btn btn-google",style:{width:"100%",display:"none"},children:[e.jsx("span",{children:"📧"})," Sign up with Google"]}),e.jsxs("div",{className:"auth-links",children:["Already have an account? ",e.jsx(Z,{to:"/signin",className:"auth-link",children:"Sign In"})]})]})})},ss=()=>{const s=$(),t=le(),[o,r]=l.useState({email:"",password:"",rememberMe:!1}),[n,i]=l.useState({}),[d,c]=l.useState(!1),[m,x]=l.useState("");l.useEffect(()=>{var j;(j=t.state)!=null&&j.message&&x(t.state.message)},[t]);const u=j=>{const{name:S,value:h,type:g,checked:N}=j.target;r(y=>({...y,[S]:g==="checkbox"?N:h})),n[S]&&i(y=>({...y,[S]:""}))},w=async j=>{var S,h;j.preventDefault(),c(!0),i({});try{await z.signin(o),s("/")}catch(g){i({submit:((h=(S=g.response)==null?void 0:S.data)==null?void 0:h.message)||"Sign in failed"})}finally{c(!1)}};return e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card",children:[e.jsxs("div",{className:"auth-header",children:[e.jsx("h1",{className:"auth-title",children:"Welcome Back"}),e.jsx("p",{className:"auth-subtitle",children:"Sign in to your account"})]}),m&&e.jsx("div",{className:"success-message",style:{textAlign:"center",marginBottom:"1rem"},children:m}),e.jsxs("form",{onSubmit:w,className:"auth-form",children:[e.jsx(oe,{label:"Email",type:"email",name:"email",value:o.email,onChange:u,placeholder:"you@example.com",required:!0,error:n.email}),e.jsx(ee,{label:"Password",name:"password",value:o.password,onChange:u,placeholder:"Your account password",required:!0,error:n.password}),e.jsx("div",{className:"form-group",children:e.jsxs("div",{className:"checkbox-group",children:[e.jsx("input",{type:"checkbox",id:"rememberMe",name:"rememberMe",checked:o.rememberMe,onChange:u,className:"checkbox"}),e.jsx("label",{htmlFor:"rememberMe",className:"form-label",style:{marginBottom:0},children:"Remember me"})]})}),n.submit&&e.jsx("div",{className:"error-message",children:n.submit}),e.jsx("button",{type:"submit",className:`btn btn-primary ${d?"loading":""}`,style:{width:"100%"},disabled:d,children:d?e.jsx("span",{className:"spinner"}):"Sign In"})]}),e.jsx("div",{className:"auth-links",style:{marginBottom:"1rem"},children:e.jsx(Z,{to:"/forgot-password",className:"auth-link",children:"Forgot Password?"})}),e.jsx("div",{className:"auth-divider",children:e.jsx("span",{children:"or"})}),e.jsxs("button",{className:"btn btn-google",style:{width:"100%",display:"none"},children:[e.jsx("span",{children:"📧"})," Sign in with Google"]}),e.jsxs("div",{className:"auth-links",children:["Don't have an account? ",e.jsx(Z,{to:"/signup",className:"auth-link",children:"Create Account"})]})]})})},ts=()=>{const s=$(),[t,o]=l.useState(""),[r,n]=l.useState(!1),[i,d]=l.useState(""),[c,m]=l.useState(""),x=async u=>{var w,j;u.preventDefault(),n(!0),m(""),d("");try{await z.forgotPassword(t),d("If an account with this email exists, we've sent you an OTP."),setTimeout(()=>{s("/verify-otp",{state:{email:t}})},2e3)}catch(S){m(((j=(w=S.response)==null?void 0:w.data)==null?void 0:j.message)||"Failed to send OTP")}finally{n(!1)}};return e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card",children:[e.jsxs("div",{className:"auth-header",children:[e.jsx("h1",{className:"auth-title",children:"Forgot Password"}),e.jsx("p",{className:"auth-subtitle",children:"We'll send a 6-digit OTP to your email"})]}),e.jsxs("form",{onSubmit:x,className:"auth-form",children:[e.jsx(oe,{label:"Email",type:"email",name:"email",value:t,onChange:u=>o(u.target.value),placeholder:"you@example.com",required:!0}),c&&e.jsx("div",{className:"error-message",children:c}),i&&e.jsx("div",{className:"success-message",children:i}),e.jsx("button",{type:"submit",className:`btn btn-primary ${r?"loading":""}`,style:{width:"100%"},disabled:r,children:r?e.jsx("span",{className:"spinner"}):"Send OTP"})]}),e.jsxs("div",{className:"auth-links",children:["Remember your password? ",e.jsx(Z,{to:"/signin",className:"auth-link",children:"Sign In"})]})]})})},as=({length:s=6,onComplete:t,error:o})=>{const[r,n]=l.useState(new Array(s).fill("")),i=l.useRef([]);l.useEffect(()=>{i.current[0]&&i.current[0].focus()},[]);const d=(m,x)=>{if(isNaN(m.value))return;const u=[...r];u[x]=m.value,n(u),m.value&&x<s-1&&i.current[x+1].focus(),u.every(w=>w!=="")&&t(u.join(""))},c=(m,x)=>{m.key==="Backspace"&&!r[x]&&x>0&&i.current[x-1].focus()};return e.jsxs("div",{className:"form-group",children:[e.jsx("div",{className:"otp-input-container",children:r.map((m,x)=>e.jsx("input",{type:"text",maxLength:"1",value:m,onChange:u=>d(u.target,x),onKeyDown:u=>c(u,x),ref:u=>i.current[x]=u,className:"otp-digit"},x))}),o&&e.jsx("div",{className:"error-message",children:o})]})},ns=()=>{var g;const s=$(),t=le(),[o]=l.useState(((g=t.state)==null?void 0:g.email)||""),[r,n]=l.useState(""),[i,d]=l.useState(!1),[c,m]=l.useState(""),[x,u]=l.useState(60),[w,j]=l.useState(!1);l.useEffect(()=>{if(!o){s("/forgot-password");return}const N=setInterval(()=>{u(y=>y<=1?(j(!0),clearInterval(N),0):y-1)},1e3);return()=>clearInterval(N)},[o,s]);const S=async N=>{var y,A;n(N),d(!0),m("");try{const q=await z.verifyOtp(o,N);s("/reset-password",{state:{resetToken:q.resetToken,email:o}})}catch(q){m(((A=(y=q.response)==null?void 0:y.data)==null?void 0:A.message)||"Invalid OTP")}finally{d(!1)}},h=async()=>{if(w){d(!0);try{await z.forgotPassword(o),j(!1),u(60),m("");const N=setInterval(()=>{u(y=>y<=1?(j(!0),clearInterval(N),0):y-1)},1e3)}catch{m("Failed to resend OTP")}finally{d(!1)}}};return e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card",children:[e.jsxs("div",{className:"auth-header",children:[e.jsx("h1",{className:"auth-title",children:"Verify OTP"}),e.jsxs("p",{className:"auth-subtitle",children:["Enter the 6-digit code sent to",e.jsx("br",{}),e.jsx("strong",{children:o})]})]}),e.jsxs("div",{className:"auth-form",children:[e.jsx(as,{length:6,onComplete:S,error:c}),i&&e.jsx("div",{style:{textAlign:"center",margin:"1rem 0"},children:e.jsx("span",{className:"spinner"})}),e.jsx("div",{className:"resend-timer",children:w?e.jsx("button",{onClick:h,className:"auth-link",style:{background:"none",border:"none",cursor:"pointer"},disabled:i,children:"Resend OTP"}):e.jsxs("span",{children:["Resend OTP in ",x,"s"]})})]}),e.jsx("div",{className:"auth-links",children:e.jsx(Z,{to:"/forgot-password",className:"auth-link",children:"← Back to Email"})})]})})},rs=()=>{var S,h;const s=$(),t=le(),[o]=l.useState(((S=t.state)==null?void 0:S.resetToken)||""),[r]=l.useState(((h=t.state)==null?void 0:h.email)||""),[n,i]=l.useState({newPassword:"",confirmPassword:""}),[d,c]=l.useState({}),[m,x]=l.useState(!1);l.useEffect(()=>{(!o||!r)&&s("/forgot-password")},[o,r,s]);const u=g=>{const{name:N,value:y}=g.target;i(A=>({...A,[N]:y})),d[N]&&c(A=>({...A,[N]:""}))},w=()=>{const g={};return n.newPassword?n.newPassword.length<8&&(g.newPassword="Password must be at least 8 characters"):g.newPassword="New password is required",n.newPassword!==n.confirmPassword&&(g.confirmPassword="Passwords do not match"),c(g),Object.keys(g).length===0},j=async g=>{var N,y;if(g.preventDefault(),!!w()){x(!0);try{await z.resetPassword(n.newPassword,n.confirmPassword,o),s("/signin",{state:{message:"Password reset successful! Please sign in with your new password."}})}catch(A){c({submit:((y=(N=A.response)==null?void 0:N.data)==null?void 0:y.message)||"Password reset failed"})}finally{x(!1)}}};return e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card",children:[e.jsxs("div",{className:"auth-header",children:[e.jsx("h1",{className:"auth-title",children:"Reset Password"}),e.jsxs("p",{className:"auth-subtitle",children:["Create a new password for",e.jsx("br",{}),e.jsx("strong",{children:r})]})]}),e.jsxs("form",{onSubmit:j,className:"auth-form",children:[e.jsx(ee,{label:"New Password",name:"newPassword",value:n.newPassword,onChange:u,placeholder:"At least 8 characters",required:!0,error:d.newPassword}),e.jsx(ee,{label:"Confirm New Password",name:"confirmPassword",value:n.confirmPassword,onChange:u,placeholder:"Re-enter your new password",required:!0,error:d.confirmPassword}),d.submit&&e.jsx("div",{className:"error-message",children:d.submit}),e.jsx("button",{type:"submit",className:`btn btn-primary ${m?"loading":""}`,style:{width:"100%"},disabled:m,children:m?e.jsx("span",{className:"spinner"}):"Reset Password"})]})]})})};function os(){const t=le().pathname.startsWith("/editor");return e.jsxs("div",{className:"App",children:[!t&&e.jsx(Qe,{}),e.jsxs(Me,{children:[e.jsx(B,{path:"/",element:e.jsx(Ye,{})}),e.jsx(B,{path:"/editor",element:e.jsx(fe,{})}),e.jsx(B,{path:"/editor/:id",element:e.jsx(fe,{})}),e.jsx(B,{path:"/profile",element:e.jsx(Ze,{})}),e.jsx(B,{path:"/signup",element:e.jsx(es,{})}),e.jsx(B,{path:"/signin",element:e.jsx(ss,{})}),e.jsx(B,{path:"/forgot-password",element:e.jsx(ts,{})}),e.jsx(B,{path:"/verify-otp",element:e.jsx(ns,{})}),e.jsx(B,{path:"/reset-password",element:e.jsx(rs,{})})]})]})}function ls(){const[s,t]=l.useState(()=>localStorage.getItem("theme")||"dark"),[o,r]=l.useState(!0);return l.useEffect(()=>{document.documentElement.setAttribute("data-theme",s),localStorage.setItem("theme",s)},[s]),l.useEffect(()=>{const n=setTimeout(()=>{r(!1)},3e3);return()=>clearTimeout(n)},[]),o?e.jsx(Ke,{}):e.jsx(Fe,{children:e.jsx(os,{})})}ue.createRoot(document.getElementById("root")).render(e.jsx(Ne.StrictMode,{children:e.jsx(ls,{})}));
